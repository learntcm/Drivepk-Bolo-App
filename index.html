<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DrivePK Bolo App</title>

<style>
html { font-size:16px; }
body {
  margin:0;
  font-family:Arial, sans-serif;
  background:#f2f2f2;
}

header {
  background:#000;
  color:#fff;
  padding:16px;
  display:flex;
  align-items:center;
  gap:12px;
}

.logo {
  background:#E81F25;
  width:52px;
  height:52px;
  border-radius:14px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:22px;
  font-weight:bold;
}

.main { padding:16px; }

.hero {
  background:#000;
  border-radius:30px;
  height:70vh;
  min-height:450px;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  color:#fff;
  margin-bottom:20px;
}

.hero h1 { font-size:64px; margin:0; }
.hero h2 { margin-top:14px; font-size:28px; color:#E81F25; }

input, button {
  width:100%;
  height:62px;
  border-radius:18px;
  font-size:18px;
}

input {
  padding:0 20px;
  border:1px solid #ccc;
  margin-bottom:12px;
}

button {
  border:none;
  background:#000;
  color:#fff;
}

.call {
  background:#E81F25;
  font-size:22px;
  margin-top:12px;
}

#status {
  margin-top:14px;
  font-size:18px;
  font-weight:bold;
  color:#E81F25;
  display:none;
}

#results {
  background:#fff;
  border-radius:20px;
  padding:16px;
  margin-top:18px;
}

.car {
  padding:14px 0;
  border-bottom:1px solid #ddd;
}
.car:last-child { border-bottom:none; }
</style>
</head>

<body>

<header>
  <div class="logo">D</div>
  <div>
    <strong>DrivePK</strong><br>
    <small>Bolo aur gaari dhoondo</small>
  </div>
</header>

<div class="main">

  <div class="hero">
    <h1>MG</h1>
    <h2>MG HS</h2>
  </div>

  <input id="query" placeholder="Type car search here (e.g. Honda in Lahore)">
  <button id="searchBtn">Search</button>
  <button class="call" id="callBtn">ðŸ“ž CALL</button>

  <div id="status">Reshma: Assalam-o-Alaikumâ€¦</div>
  <div id="results"></div>

</div>

<audio id="reshmaAudio" preload="none"></audio>

<script>
/* ===============================
   CALL â†’ RESHMA VOICE (FIXED)
   =============================== */
function callReshma() {
  const status = document.getElementById("status");
  const audio = document.getElementById("reshmaAudio");

  status.style.display = "block";

  audio.src =
    "https://meilibeautyco/voice.php?text=" +
    encodeURIComponent(
      "Assalam o Alaikum! Main Reshma hoon DrivePK se. Aap kaunsi gaari dhoondh rahe hain?"
    );

  audio.currentTime = 0;
  audio.play().catch(() => {});
}

/* ===============================
   SEARCH â†’ DRIVEPK PHP (ROBUST)
   =============================== */
async function runSearch(text) {
  const results = document.getElementById("results");
  results.innerHTML = "<p>Searchingâ€¦</p>";

  try {
    const res = await fetch(
      "https://meilibeautyco/search.php?query=" +
      encodeURIComponent(text),
      { method: "GET" }
    );

    const raw = await res.text();

    let data;
    try {
      data = JSON.parse(raw);
    } catch {
      results.innerHTML = "<p>No results found</p>";
      return;
    }

    if (!Array.isArray(data) || data.length === 0) {
      results.innerHTML = "<p>No cars found</p>";
      return;
    }

    results.innerHTML = "";
    data.forEach(c => {
      results.innerHTML += `
        <div class="car">
          <strong>${c.brand || ""} ${c.model || ""}</strong><br>
          ${c.city || ""} ${c.price ? "â€¢ PKR " + c.price : ""}
        </div>
      `;
    });

  } catch {
    results.innerHTML = "<p>Search service unavailable</p>";
  }
}

/* ===============================
   BUTTONS
   =============================== */
document.getElementById("callBtn").onclick = () => {
  callReshma();
};

document.getElementById("searchBtn").onclick = () => {
  const text = document.getElementById("query").value.trim();
  if (text) runSearch(text);
};

document.getElementById("query").addEventListener("keydown", e => {
  if (e.key === "Enter") {
    const text = document.getElementById("query").value.trim();
    if (text) runSearch(text);
  }
});
</script>

</body>
</html>
